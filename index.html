<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrix Chat Terminal</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-messaging.js"></script>
    
    <style>
        body { 
            margin: 0; padding: 0; background: black; 
            color: #00FF41; font-family: 'Courier New', monospace;
            overflow: hidden; height: 100vh;
        }
        #matrix-canvas { position: fixed; top: 0; left: 0; z-index: -1; }
        #chat-container { display: flex; flex-direction: column; height: 100vh; background: rgba(0, 0, 0, 0.8); }
        #messages { flex: 1; overflow-y: auto; padding: 15px; }
        .msg { margin-bottom: 12px; border-left: 2px solid #00FF41; padding: 5px 10px; word-wrap: break-word; }
        .input-area { padding: 15px; background: #000; border-top: 1px solid #00FF41; display: flex; gap: 5px; }
        input { background: #000; border: 1px solid #00FF41; color: #00FF41; padding: 10px; outline: none; font-size: 16px; }
        #nameInput { width: 60px; }
        #messageInput { flex: 1; }
        button { background: #00FF41; color: #000; border: none; padding: 10px 15px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

<canvas id="matrix-canvas"></canvas>

<div id="chat-container">
    <div id="messages"></div>
    <div class="input-area">
        <input type="text" id="nameInput" placeholder="ID">
        <input type="text" id="messageInput" placeholder="COMMAND...">
        <button onclick="sendMessage()">SEND</button>
    </div>
</div>

<script>
    // 1. Matrix Background Animation
    const canvas = document.getElementById('matrix-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    const letters = "01010101ABCDEF";
    const fontSize = 16;
    const drops = Array(Math.floor(canvas.width / fontSize)).fill(1);
    function drawMatrix() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.1)'; ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#00FF41'; ctx.font = fontSize + 'px monospace';
        drops.forEach((y, i) => {
            const text = letters.charAt(Math.floor(Math.random() * letters.length));
            ctx.fillText(text, i * fontSize, y * fontSize);
            if (y * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
            drops[i]++;
        });
    }
    setInterval(drawMatrix, 50);

    // 2. Ninte Puthiya Firebase Config
    const firebaseConfig = {
        apiKey: "AIzaSyAuG5oubTBwUKYXp5oYqzQoNpH2YOAKIOU",
        authDomain: "chatbot-a809c.firebaseapp.com",
        databaseURL: "https://chatbot-a809c-default-rtdb.firebaseio.com",
        projectId: "chatbot-a809c",
        storageBucket: "chatbot-a809c.firebasestorage.app",
        messagingSenderId: "875283424596",
        appId: "1:875283424596:web:a45216f87240e4f68814c1",
        measurementId: "G-FB6BXMS5SC"
    };

    // Firebase Initialize
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const messaging = firebase.messaging();

    // 3. Notification Logic
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('firebase-messaging-sw.js')
        .then((reg) => {
            Notification.requestPermission().then((permission) => {
                if (permission === 'granted') {
                    messaging.getToken({ 
                        vapidKey: 'BD4eSAGpk9MS4Ur22t6geA3lYbvf8ecIE7Du8CpXO2HQvluu_G9_2VU4rWN_N6Z8SIvpU33QULszkNWyVKoZW7U' 
                    }).then((token) => {
                        console.log("Device Token:", token);
                    });
                }
            });
        });
    }

    // 4. Chat Functions
    function sendMessage() {
        const name = document.getElementById('nameInput').value || "ANON";
        const msg = document.getElementById('messageInput').value;
        if (msg.trim() === "") return;
        
        database.ref("messages").push().set({
            "sender": name,
            "message": msg,
            "time": new Date().toLocaleTimeString()
        });
        document.getElementById('messageInput').value = "";
    }

    database.ref("messages").limitToLast(20).on("child_added", (snapshot) => {
        const data = snapshot.val();
        const msgDiv = document.getElementById('messages');
        const newMsg = document.createElement("div");
        newMsg.className = "msg";
        newMsg.innerHTML = `<b>${data.sender}:</b> ${data.message}`;
        msgDiv.appendChild(newMsg);
        msgDiv.scrollTop = msgDiv.scrollHeight;
    });
</script>

</body>
</html>


